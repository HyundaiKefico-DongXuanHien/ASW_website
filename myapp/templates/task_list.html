<!--
# ============================================================================
# FILE NAME     : myapp/task_list.py
# AUTHOR        : DONG XUAN HIEN
# DIVISION      : HYUNDAI KEFICO Co.,Ltd.
# DESCRIPTION   : Define HTML
# HISTORY       : 06/11/2025
# ============================================================================
-->

{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Tracking</title>
    <link rel="stylesheet" href="{% static 'style.css' %}">
</head>

<body>
    <div>       
        <h1>Task Tracking</h1>

    <form method="GET" class="search-form">
            <center>
            <input type="text" name="search" placeholder="Search keywords" value="{{ query }}">
            <button type="submit">Search</button>
            </center>
    </div>

    <table>
        <thead>
            <tr>
                <th>Key
                    <select name="key" onchange="this.form.submit()">
                        <option value="">All</option>
                        {% for k in keys %}
                            <option value="{{ k }}" {% if filters.key == k %}selected{% endif %}>{{ k }}</option>
                        {% endfor %}
                    </select>                   
                </th> 
                <th>Request Title</th>
                <th>Priority
                    <select name="priority" onchange="this.form.submit()">
                        <option value="">All</option>
                        {% for p in priorities %}
                            <option value="{{ p }}" {% if filters.priority == p %}selected{% endif %}>{{ p }}</option>
                        {% endfor %}
                    </select>          
                </th>
                <th>Reporter
                    <select name="reporter" onchange="this.form.submit()">
                        <option value="">All</option>
                        {% for r in reporters %}
                            <option value="{{ r }}" {% if filters.reporter == r %}selected{% endif %}>{{ r }}</option>
                        {% endfor %}
                    </select>           
                </th>
                <th>Assignee
                    <select name="assignee" onchange="this.form.submit()">
                        <option value="">All</option>
                        {% for a in assignees %}
                            <option value="{{ a }}" {% if filters.assignee == a %}selected{% endif %}>{{ a }}</option>
                        {% endfor %}
                    </select>
                </th>
                <th>Status
                    <select name="status" onchange="this.form.submit()">
                        <option value="">All</option>
                        {% for s in statuses %}
                            <option value="{{ s }}" {% if filters.status == s %}selected{% endif %}>{{ s }}</option>
                        {% endfor %}
                    </select>
                </th>
                <th>Created</th>
                <th>Updated</th>
            </tr>
        </thead>
        <tbody>
            {% for task in tasks %}
            <tr>
                <td>{{ task.key }}</td>
                <td>{{ task.request_title }}</td>
                <td class="priority">
                    <span class="badge {% if task.priority == 'High' %}high{% elif task.priority == 'Medium' %}medium{% else %}low{% endif %}">{{ task.priority }}
                    </span>
                </td>
                <td>{{ task.reporter }}</td>
                <td>{{ task.assignee }}</td>
                <td class="status">
                    <span class="badge {% if task.status == 'Done' %}done{% elif task.status == 'In Progress' %}in-progress{% else %}todo{% endif %}">{{ task.status }}
                    </span>
                </td>
                <td>{{ task.created }}</td>
                <td>{{ task.updated }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    </form> 
</body>
</html>